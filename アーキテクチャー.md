# システムアーキテクチャ概要

本システムは、リアルタイム通信を核とした分散アーキテクチャを採用しており、主に以下の二つのコンポーネントで構成されています。

## 1. `bridge-server` (バックエンドサーバー)

`bridge-server` は、システムのバックエンドロジックとリアルタイム通信ハブとしての役割を担います。

### 主な役割と機能:

*   **リアルタイム通信の管理:**
    *   `socket.ts` ファイルや `Socket.IO` の利用から、クライアント（`mobile-client` など）とのWebSocketを用いたリアルタイム通信を管理します。エージェントとのインタラクションや状態更新などをリアルタイムでクライアントにプッシュする役割を担います。
*   **バックエンドAPIの提供:**
    *   `app.ts` や `index.ts` から、主要なビジネスロジックを実行し、クライアントからのリクエストに応答するAPIエンドポイントを提供します。
*   **AIモデル関連処理:**
    *   `check_models.ts` や `debug-models.js` の存在から、AIモデルの検証、デバッグ、または推論処理をバックエンドで実行する役割を持つ可能性があります。
*   **イベント処理とルーティング:**
    *   `runner.ts` などのファイルは、特定のイベントに応じた処理の実行や、リクエストのルーティングを担うことが考えられます。
*   **ロギングと監視:**
    *   `backend.log` や `debug_models.log` などのログファイルから、サーバーの動作状況やAIモデルの処理状況を記録し、デバッグや監視に利用されます。

### 技術スタックの推測:

*   Node.js (TypeScript)
*   Express.js (または類似のWebフレームワーク)
*   Socket.IO

## 2. `mobile-client` (フロントエンドクライアント)

`mobile-client` は、ユーザーが直接操作するインターフェース（UI）を提供し、`bridge-server` とのリアルタイム通信を通じてシステムとインタラクションする役割を担います。

### 主な役割と機能:

*   **ユーザーインターフェース (UI) の提供:**
    *   `app` ディレクトリ内の `layout.tsx`, `page.tsx` や `components` ディレクトリ内の `AgentStatus.tsx`, `ChatInput.tsx`, `MessageList.tsx` から、ユーザーがエージェントとチャットしたり、システムの状態を確認したりするための視覚的なUIを構築します。
*   **ユーザー入力の処理:**
    *   `ChatInput.tsx` から、ユーザーからのテキスト入力などの操作を受け付け、`bridge-server` へ送信します。
*   **リアルタイムデータの表示:**
    *   `MessageList.tsx` や `AgentStatus.tsx` は、`bridge-server` から受信したエージェントのメッセージやステータスをリアルタイムでユーザーに表示します。
*   **バックエンドとの通信:**
    *   `hooks/useAgentSocket.ts` の存在から、`bridge-server` とのWebSocket通信を管理し、メッセージの送受信を行います。
*   **クライアントサイドロジック:**
    *   データの整形、UIの状態管理など、クライアント側で完結するロジックを処理します。

### 技術スタックの推測:

*   Next.js
*   React
*   TypeScript
*   Tailwind CSS (CSSフレームワーク)

## 役割の違いのまとめ

| 特徴       | `bridge-server`                               | `mobile-client`                               |
| :--------- | :-------------------------------------------- | :-------------------------------------------- |
| **役割**   | バックエンドロジック、リアルタイム通信ハブ、AIモデル処理 | ユーザーインターフェース、UXの提供、リアルタイムデータ表示 |
| **ユーザーとの接点** | 直接の接点はなく、クライアントを介して機能を提供 | ユーザーが直接操作する画面を提供する        |
| **通信**   | クライアントからのリクエスト処理、リアルタイムデータプッシュ | ユーザー入力の送信、リアルタイムデータ受信と表示 |
| **主要な成果物** | APIエンドポイント、WebSocketサーバー          | Webアプリケーション、UIコンポーネント       |

この分離されたアーキテクチャにより、各コンポーネントは独立して開発・デプロイが可能となり、スケーラビリティとメンテナンス性が向上します。